const HttpError = require("../models/http-error");
const User = require("../models/User");

const getUsers = async (req, res, next) => {
  let users;
  try {
    users = await User.find({}, "-password");
  } catch (error) {
    return next(new HttpError("Something went Wrong!", 500));
  }
  if (users.length === 0 || !users) {
    const error = new HttpError("No Users Found", 404);
    return next(error);
  }
  res
    .status(200)
    .json({ users: users.map((u) => u.toObject({ getters: true })) });
};

const signUp = async (req, res, next) => {
  const { name, email, password } = req.body;

  let existUser;
  try {
    existUser = await User.findOne({ email });
  } catch (error) {
    return next(new HttpError("Something went wrong! try again"), 500);
  }

  if (existUser) {
    return next(new HttpError("User Already Created"), 422);
  }

  const newUser = new User({
    name,
    email,
    image: "data:image/jpeg;base64,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",
    password,
    places: [],
  });

  let user;
  try {
    user = await newUser.save();
  } catch (err) {
    const error = new HttpError(
      "Creating place failed, please try again.",
      500
    );
    return next(error);
  }
  res.status(200).json({ user: user.toObject({ getters: true }) });
};

const loginIn = async (req, res, next) => {
  const { email, password } = req.body;

  let existUser;
  try {
    existUser = await User.findOne({ email });
  } catch (err) {
    const error = new HttpError(
      "Creating place failed, please try again.",
      500
    );
    return next(error);
  }

  if (!existUser) {
    return next(new HttpError("User not created", 401));
  }

  if (password !== existUser.password) {
    return next(new HttpError("Invalid Password", 401));
  }

  res.status(201).json({ message: "Login successful", user: existUser.toObject({ getters: true }) });
};

module.exports = {
  getUsers,
  signUp,
  loginIn,
};
